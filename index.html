<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solar System WebAR</title>
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/ar.js@1.7.2/aframe-ar.min.js"></script>

</head>
<body style="margin: 0; overflow: hidden;">

    <a-scene embedded arjs>
        <a-assets>
            <a-asset-item id="solarModel" src="https://modelviewer.dev/shared-assets/models/Astronaut.glb"></a-asset-item>
        </a-assets>
<!--         <a-entity gltf-model="https://cdn.aframe.io/test-models/models/knight/knight.gltf"
          position="0 1 -3"
          scale="1 1 1">
</a-entity> -->

        <!-- Solar System Model -->
        <a-entity 
          id="solarSystem"
          gltf-model="https://modelviewer.dev/shared-assets/models/Astronaut.glb"
          position="0 0 -2"
          scale="1 1 1"
          gesture-controls>
        </a-entity>
        <a-light type="directional" position="1 3 1" intensity="1"></a-light>
        <a-light type="ambient" intensity="0.5"></a-light>

        

        <!-- Camera + Cursor -->
        <a-camera position="0 1.6 0">
            <a-cursor></a-cursor>
        </a-camera>
    </a-scene>

    <script>
        AFRAME.registerComponent('gesture-controls', {
            init: function () {
                let el = this.el;
                let startX, startY, startScale = 1;
                let isPinching = false, initialDistance = 0;

                // Touch Start Event
                el.sceneEl.addEventListener('touchstart', function (event) {
                    if (event.touches.length === 1) {
                        startX = event.touches[0].clientX;
                        startY = event.touches[0].clientY;
                    }
                    if (event.touches.length === 2) {
                        isPinching = true;
                        let dx = event.touches[0].clientX - event.touches[1].clientX;
                        let dy = event.touches[0].clientY - event.touches[1].clientY;
                        initialDistance = Math.sqrt(dx * dx + dy * dy);
                    }
                });

                // Touch Move Event
                el.sceneEl.addEventListener('touchmove', function (event) {
                    if (isPinching && event.touches.length === 2) {
                        let dx = event.touches[0].clientX - event.touches[1].clientX;
                        let dy = event.touches[0].clientY - event.touches[1].clientY;
                        let newDistance = Math.sqrt(dx * dx + dy * dy);
                        let scaleChange = newDistance / initialDistance;
                        el.object3D.scale.set(scaleChange, scaleChange, scaleChange);
                    } else if (event.touches.length === 1) {
                        let deltaX = event.touches[0].clientX - startX;
                        el.object3D.rotation.y += deltaX * 0.005;
                        startX = event.touches[0].clientX;
                    }
                });

                // Touch End Event
                el.sceneEl.addEventListener('touchend', function () {
                    isPinching = false;
                });

                // Tap Event (for showing info)
                el.sceneEl.addEventListener('click', function () {
                    alert("You tapped on the solar system!");
                });
            }
        });
    </script>
</body>
</html>
